<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pystablemotifs.restrict_space API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pystablemotifs.restrict_space</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import pyboolnet.boolean_logic
import re

from pystablemotifs.drivers import single_drivers, logical_domain_of_influence
import pystablemotifs.drivers as sm_doi

def attractor_space_candidates(maxts,trmaxts):
    &#34;&#34;&#34;Merge the maximum trap spaces maxts and time-reverse maximum trap spaces
    to obtain a list of attractor-conserved quantities. Note that any Boolean
    function of these is also conserved in attractors.

    Parameters
    ----------
    maxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the system.
    trmaxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the time-reversed system.

    Returns
    -------
    rspace list
        Restrict space list (see restrict_space.rspace for details).

    &#34;&#34;&#34;

    L = []
    for t in maxts+trmaxts: L.append([t])
    return L

def state_in_rspace(state,L):
    &#34;&#34;&#34;Tests to see if state is in the rspace L.

    Parameters
    ----------
    state : partial state dictionary
        State, or partial state to test.
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).

    Returns
    -------
    bool
        True if and only if state is in L.

    &#34;&#34;&#34;
    for clause in L:
        sat = False
        for p in clause:
            if sm_doi.fixed_implies_implicant(state,p):
                sat = True
                break
        if not sat:
            return False
    return True

def partial_state_contradicts_rspace(state,L):
    &#34;&#34;&#34;Tests to see if state lies entirely outside the rspace L.

    Parameters
    ----------
    state : partial state dictionary
        State, or partial state to test.
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).

    Returns
    -------
    bool
        True if and only if state is not in L.

    &#34;&#34;&#34;
    for clause in L:
        csat = False
        for p in clause:
            if not sm_doi.fixed_excludes_implicant(state,p):
                csat = True
                break
        if not csat:
            return False
    return True

def reduce_rspace(L,primes):
    &#34;&#34;&#34;Reduce the rspace L for the system given by primes so that trivially fixed
    nodes are factored out. The first element of the returned rspace (L2) will
    specify these trivially fixed nodes (i.e., they are factored on the left).

    Parameters
    ----------
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).
    primes : pyboolnet primes dictionary
        Update rule for the system.

    Returns
    -------
    L2 : rspace list
        Reduced restrict space list (see restrict_space.rspace for details).

    &#34;&#34;&#34;
    fixed = fixed_rspace_nodes(L,primes)
    L2 = [[fixed]]
    for clause in L:
        sat = False
        for p in clause:
            if sm_doi.fixed_implies_implicant(fixed,p):
                sat = True
                break
        if not sat:
            L2.append(clause)
    return L2

def rspace(maxts,trmaxts,primes):
    &#34;&#34;&#34;In order for none of the trap spaces to &#34;lock in&#34;, we would require that
    their single-node drivers are all sustained in a negated state. We can use
    this idea to hone the exclusion space. rspace will return the region that


    1) has the negations of 1-node drivers of each maxts active and . . .
    2) has the update rules of these 1-node drivers taking the appropriate value

    In addition, a time-reverse trap space (trmaxts) describes a region that,
    once exited, cannot be reentered. Thus, if the LDOI of the region contains
    any contradiciton, the region cannot contain any attractor. Therefore,
    we include a third criterion for the rspace:

    3) is not in a state belonging to an attractor-free time-reversed trap space

    The return value is a list L of lists of prime implicants. Each element of L
    is to be interpreted as a list of OR-separated prime implicants; L is to be
    interpreted as AND-separated. e.g.,
    L=[[{&#39;A&#39;:0,&#39;B&#39;:1},{C:0}],[{&#39;B&#39;:0,&#39;D&#39;:1},{&#39;A&#39;:1}]]
    should be read as L = (!A&amp;B | !C) &amp; (!B &amp; D | A)

    Parameters
    ----------
    maxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the system.
    trmaxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the time-reversed system.
    primes : pyboolnet primes dictionary
        Update rule for the system.

    Returns
    -------
    L : rspace list
        Description of rspace in list form (see summary above for details).

    &#34;&#34;&#34;
    L = []
    nds = {} # negated 1-node drivers of the stable motifs in maxts
    for ts in maxts:
        # Make sure we aren&#39;t in the stable motif ts
        clause = []
        for k,v in ts.items():
            clause.append({k:int(not v)})
        L.append(clause)

        # Now consider drivers of ts
        drivers = single_drivers(ts,primes)
        for d in drivers:
            node = list(d.keys())[0] # d only has 1 key because its a 1-node driver set
            if node in nds:
                if nds[node] == d[node]:
                    return [[{&#39;0&#39;:1}]] # In this case, at least one SM MUST stabilize
            nds[node] = int(not d[node])
    implied,contradicted = logical_domain_of_influence(nds,primes)
    if len(contradicted) != 0:
        return [[{&#39;0&#39;:1}]] # In this case, at least one SM MUST stabilize

    for k in implied: nds[k]=implied[k]

    L.append([nds])

    # also include the conditions for the update rules of the negated drivers
    for k in nds:
        L.append(primes[k][nds[k]])


    # Now, investigate the trmaxts:
    # If a trsm has a nonempty contradiction boundary, then it cannot contain
    # any attractor.
    for gs in trmaxts:
        implied,contradicted = logical_domain_of_influence(gs,primes)
        if len(contradicted) &gt; 0:
            L.append([{n:int(not v)} for n,v in gs.items()])

    # If the tr system gave us information, but we couldn&#39;t find any 1-node sm
    # drivers, we need to remove the null condition given by the inability to
    # find the sm drivers
    # if L[0]==[{}] and len(L) &gt; 0:
    #     L = L[1:]

    return L

def fixed_rspace_nodes(L,primes):
    &#34;&#34;&#34;Finds the nodes that must have a fixed value in order for the rspace
    constraint L to be satisfied in the system given by primes.


    Parameters
    ----------
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).
    primes : pyboolnet primes dictionary
        Update rule for the system.

    Returns
    -------
    dictionary
        Nodes that are fixed everywhere in the rspace L. Returns {&#39;0&#39;:1} if L is
        a self-contradictory.

    &#34;&#34;&#34;
    fL = [r[0] for r in L if len(r)==1]

    fd = {}
    for d in fL:
        for k,v in d.items():
            if k in fd and fd[k] != v:
                return {&#39;0&#39;:1}
            else:
                fd[k] = v

    imp,con = logical_domain_of_influence(fd,primes)

    if len(con) &gt; 0:
        return {&#39;0&#39;:1}
    fd.update(imp)
    return fd

def reduce_rspace_string(s,fd,simplify=True):
    &#34;&#34;&#34;Replaces variables in the string s with the fixed values given by the dictionary fd.

    Parameters
    ----------
    s : str
        Boolean expression in BNET format.
    fd : partial state dictionary
        Node values that are to be considered fixed.
    simplify : bool
        Whether to simplify the expression using espresso (the default is True).

    Returns
    -------
    str
        String with substitutions made according to fd.

    &#34;&#34;&#34;
    s2 = s
    for k,v in fd.items():
        s2 = re.sub(rf&#34;\b{k}\b&#34;,str(v),s2)
    if simplify:
        s2 = pyboolnet.boolean_logic.minimize_espresso(s2)
    return s2</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pystablemotifs.restrict_space.attractor_space_candidates"><code class="name flex">
<span>def <span class="ident">attractor_space_candidates</span></span>(<span>maxts, trmaxts)</span>
</code></dt>
<dd>
<div class="desc"><p>Merge the maximum trap spaces maxts and time-reverse maximum trap spaces
to obtain a list of attractor-conserved quantities. Note that any Boolean
function of these is also conserved in attractors.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>maxts</code></strong> :&ensp;<code>list</code> of <code>partial state dictionaries</code></dt>
<dd>Stable motifs, i.e., maximum trap spaces for the system.</dd>
<dt><strong><code>trmaxts</code></strong> :&ensp;<code>list</code> of <code>partial state dictionaries</code></dt>
<dd>Stable motifs, i.e., maximum trap spaces for the time-reversed system.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Restrict space list (see restrict_space.rspace for details).</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def attractor_space_candidates(maxts,trmaxts):
    &#34;&#34;&#34;Merge the maximum trap spaces maxts and time-reverse maximum trap spaces
    to obtain a list of attractor-conserved quantities. Note that any Boolean
    function of these is also conserved in attractors.

    Parameters
    ----------
    maxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the system.
    trmaxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the time-reversed system.

    Returns
    -------
    rspace list
        Restrict space list (see restrict_space.rspace for details).

    &#34;&#34;&#34;

    L = []
    for t in maxts+trmaxts: L.append([t])
    return L</code></pre>
</details>
</dd>
<dt id="pystablemotifs.restrict_space.fixed_rspace_nodes"><code class="name flex">
<span>def <span class="ident">fixed_rspace_nodes</span></span>(<span>L, primes)</span>
</code></dt>
<dd>
<div class="desc"><p>Finds the nodes that must have a fixed value in order for the rspace
constraint L to be satisfied in the system given by primes.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>L</code></strong> :&ensp;<code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Restrict space list (see restrict_space.rspace for details).</dd>
<dt><strong><code>primes</code></strong> :&ensp;<code>pyboolnet primes dictionary</code></dt>
<dd>Update rule for the system.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dictionary</code></dt>
<dd>Nodes that are fixed everywhere in the rspace L. Returns {'0':1} if L is
a self-contradictory.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def fixed_rspace_nodes(L,primes):
    &#34;&#34;&#34;Finds the nodes that must have a fixed value in order for the rspace
    constraint L to be satisfied in the system given by primes.


    Parameters
    ----------
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).
    primes : pyboolnet primes dictionary
        Update rule for the system.

    Returns
    -------
    dictionary
        Nodes that are fixed everywhere in the rspace L. Returns {&#39;0&#39;:1} if L is
        a self-contradictory.

    &#34;&#34;&#34;
    fL = [r[0] for r in L if len(r)==1]

    fd = {}
    for d in fL:
        for k,v in d.items():
            if k in fd and fd[k] != v:
                return {&#39;0&#39;:1}
            else:
                fd[k] = v

    imp,con = logical_domain_of_influence(fd,primes)

    if len(con) &gt; 0:
        return {&#39;0&#39;:1}
    fd.update(imp)
    return fd</code></pre>
</details>
</dd>
<dt id="pystablemotifs.restrict_space.partial_state_contradicts_rspace"><code class="name flex">
<span>def <span class="ident">partial_state_contradicts_rspace</span></span>(<span>state, L)</span>
</code></dt>
<dd>
<div class="desc"><p>Tests to see if state lies entirely outside the rspace L.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>state</code></strong> :&ensp;<code>partial state dictionary</code></dt>
<dd>State, or partial state to test.</dd>
<dt><strong><code>L</code></strong> :&ensp;<code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Restrict space list (see restrict_space.rspace for details).</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if and only if state is not in L.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def partial_state_contradicts_rspace(state,L):
    &#34;&#34;&#34;Tests to see if state lies entirely outside the rspace L.

    Parameters
    ----------
    state : partial state dictionary
        State, or partial state to test.
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).

    Returns
    -------
    bool
        True if and only if state is not in L.

    &#34;&#34;&#34;
    for clause in L:
        csat = False
        for p in clause:
            if not sm_doi.fixed_excludes_implicant(state,p):
                csat = True
                break
        if not csat:
            return False
    return True</code></pre>
</details>
</dd>
<dt id="pystablemotifs.restrict_space.reduce_rspace"><code class="name flex">
<span>def <span class="ident">reduce_rspace</span></span>(<span>L, primes)</span>
</code></dt>
<dd>
<div class="desc"><p>Reduce the rspace L for the system given by primes so that trivially fixed
nodes are factored out. The first element of the returned rspace (L2) will
specify these trivially fixed nodes (i.e., they are factored on the left).</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>L</code></strong> :&ensp;<code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Restrict space list (see restrict_space.rspace for details).</dd>
<dt><strong><code>primes</code></strong> :&ensp;<code>pyboolnet primes dictionary</code></dt>
<dd>Update rule for the system.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>L2</code></strong> :&ensp;<code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Reduced restrict space list (see restrict_space.rspace for details).</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reduce_rspace(L,primes):
    &#34;&#34;&#34;Reduce the rspace L for the system given by primes so that trivially fixed
    nodes are factored out. The first element of the returned rspace (L2) will
    specify these trivially fixed nodes (i.e., they are factored on the left).

    Parameters
    ----------
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).
    primes : pyboolnet primes dictionary
        Update rule for the system.

    Returns
    -------
    L2 : rspace list
        Reduced restrict space list (see restrict_space.rspace for details).

    &#34;&#34;&#34;
    fixed = fixed_rspace_nodes(L,primes)
    L2 = [[fixed]]
    for clause in L:
        sat = False
        for p in clause:
            if sm_doi.fixed_implies_implicant(fixed,p):
                sat = True
                break
        if not sat:
            L2.append(clause)
    return L2</code></pre>
</details>
</dd>
<dt id="pystablemotifs.restrict_space.reduce_rspace_string"><code class="name flex">
<span>def <span class="ident">reduce_rspace_string</span></span>(<span>s, fd, simplify=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Replaces variables in the string s with the fixed values given by the dictionary fd.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>s</code></strong> :&ensp;<code>str</code></dt>
<dd>Boolean expression in BNET format.</dd>
<dt><strong><code>fd</code></strong> :&ensp;<code>partial state dictionary</code></dt>
<dd>Node values that are to be considered fixed.</dd>
<dt><strong><code>simplify</code></strong> :&ensp;<code>bool</code></dt>
<dd>Whether to simplify the expression using espresso (the default is True).</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>String with substitutions made according to fd.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reduce_rspace_string(s,fd,simplify=True):
    &#34;&#34;&#34;Replaces variables in the string s with the fixed values given by the dictionary fd.

    Parameters
    ----------
    s : str
        Boolean expression in BNET format.
    fd : partial state dictionary
        Node values that are to be considered fixed.
    simplify : bool
        Whether to simplify the expression using espresso (the default is True).

    Returns
    -------
    str
        String with substitutions made according to fd.

    &#34;&#34;&#34;
    s2 = s
    for k,v in fd.items():
        s2 = re.sub(rf&#34;\b{k}\b&#34;,str(v),s2)
    if simplify:
        s2 = pyboolnet.boolean_logic.minimize_espresso(s2)
    return s2</code></pre>
</details>
</dd>
<dt id="pystablemotifs.restrict_space.rspace"><code class="name flex">
<span>def <span class="ident">rspace</span></span>(<span>maxts, trmaxts, primes)</span>
</code></dt>
<dd>
<div class="desc"><p>In order for none of the trap spaces to "lock in", we would require that
their single-node drivers are all sustained in a negated state. We can use
this idea to hone the exclusion space. rspace will return the region that</p>
<p>1) has the negations of 1-node drivers of each maxts active and . . .
2) has the update rules of these 1-node drivers taking the appropriate value</p>
<p>In addition, a time-reverse trap space (trmaxts) describes a region that,
once exited, cannot be reentered. Thus, if the LDOI of the region contains
any contradiciton, the region cannot contain any attractor. Therefore,
we include a third criterion for the rspace:</p>
<p>3) is not in a state belonging to an attractor-free time-reversed trap space</p>
<p>The return value is a list L of lists of prime implicants. Each element of L
is to be interpreted as a list of OR-separated prime implicants; L is to be
interpreted as AND-separated. e.g.,
L=[[{'A':0,'B':1},{C:0}],[{'B':0,'D':1},{'A':1}]]
should be read as L = (!A&amp;B | !C) &amp; (!B &amp; D | A)</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>maxts</code></strong> :&ensp;<code>list</code> of <code>partial state dictionaries</code></dt>
<dd>Stable motifs, i.e., maximum trap spaces for the system.</dd>
<dt><strong><code>trmaxts</code></strong> :&ensp;<code>list</code> of <code>partial state dictionaries</code></dt>
<dd>Stable motifs, i.e., maximum trap spaces for the time-reversed system.</dd>
<dt><strong><code>primes</code></strong> :&ensp;<code>pyboolnet primes dictionary</code></dt>
<dd>Update rule for the system.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>L</code></strong> :&ensp;<code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Description of rspace in list form (see summary above for details).</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rspace(maxts,trmaxts,primes):
    &#34;&#34;&#34;In order for none of the trap spaces to &#34;lock in&#34;, we would require that
    their single-node drivers are all sustained in a negated state. We can use
    this idea to hone the exclusion space. rspace will return the region that


    1) has the negations of 1-node drivers of each maxts active and . . .
    2) has the update rules of these 1-node drivers taking the appropriate value

    In addition, a time-reverse trap space (trmaxts) describes a region that,
    once exited, cannot be reentered. Thus, if the LDOI of the region contains
    any contradiciton, the region cannot contain any attractor. Therefore,
    we include a third criterion for the rspace:

    3) is not in a state belonging to an attractor-free time-reversed trap space

    The return value is a list L of lists of prime implicants. Each element of L
    is to be interpreted as a list of OR-separated prime implicants; L is to be
    interpreted as AND-separated. e.g.,
    L=[[{&#39;A&#39;:0,&#39;B&#39;:1},{C:0}],[{&#39;B&#39;:0,&#39;D&#39;:1},{&#39;A&#39;:1}]]
    should be read as L = (!A&amp;B | !C) &amp; (!B &amp; D | A)

    Parameters
    ----------
    maxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the system.
    trmaxts : list of partial state dictionaries
        Stable motifs, i.e., maximum trap spaces for the time-reversed system.
    primes : pyboolnet primes dictionary
        Update rule for the system.

    Returns
    -------
    L : rspace list
        Description of rspace in list form (see summary above for details).

    &#34;&#34;&#34;
    L = []
    nds = {} # negated 1-node drivers of the stable motifs in maxts
    for ts in maxts:
        # Make sure we aren&#39;t in the stable motif ts
        clause = []
        for k,v in ts.items():
            clause.append({k:int(not v)})
        L.append(clause)

        # Now consider drivers of ts
        drivers = single_drivers(ts,primes)
        for d in drivers:
            node = list(d.keys())[0] # d only has 1 key because its a 1-node driver set
            if node in nds:
                if nds[node] == d[node]:
                    return [[{&#39;0&#39;:1}]] # In this case, at least one SM MUST stabilize
            nds[node] = int(not d[node])
    implied,contradicted = logical_domain_of_influence(nds,primes)
    if len(contradicted) != 0:
        return [[{&#39;0&#39;:1}]] # In this case, at least one SM MUST stabilize

    for k in implied: nds[k]=implied[k]

    L.append([nds])

    # also include the conditions for the update rules of the negated drivers
    for k in nds:
        L.append(primes[k][nds[k]])


    # Now, investigate the trmaxts:
    # If a trsm has a nonempty contradiction boundary, then it cannot contain
    # any attractor.
    for gs in trmaxts:
        implied,contradicted = logical_domain_of_influence(gs,primes)
        if len(contradicted) &gt; 0:
            L.append([{n:int(not v)} for n,v in gs.items()])

    # If the tr system gave us information, but we couldn&#39;t find any 1-node sm
    # drivers, we need to remove the null condition given by the inability to
    # find the sm drivers
    # if L[0]==[{}] and len(L) &gt; 0:
    #     L = L[1:]

    return L</code></pre>
</details>
</dd>
<dt id="pystablemotifs.restrict_space.state_in_rspace"><code class="name flex">
<span>def <span class="ident">state_in_rspace</span></span>(<span>state, L)</span>
</code></dt>
<dd>
<div class="desc"><p>Tests to see if state is in the rspace L.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>state</code></strong> :&ensp;<code>partial state dictionary</code></dt>
<dd>State, or partial state to test.</dd>
<dt><strong><code>L</code></strong> :&ensp;<code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace()</a> list</code></dt>
<dd>Restrict space list (see restrict_space.rspace for details).</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if and only if state is in L.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def state_in_rspace(state,L):
    &#34;&#34;&#34;Tests to see if state is in the rspace L.

    Parameters
    ----------
    state : partial state dictionary
        State, or partial state to test.
    L : rspace list
        Restrict space list (see restrict_space.rspace for details).

    Returns
    -------
    bool
        True if and only if state is in L.

    &#34;&#34;&#34;
    for clause in L:
        sat = False
        for p in clause:
            if sm_doi.fixed_implies_implicant(state,p):
                sat = True
                break
        if not sat:
            return False
    return True</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pystablemotifs" href="index.html">pystablemotifs</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pystablemotifs.restrict_space.attractor_space_candidates" href="#pystablemotifs.restrict_space.attractor_space_candidates">attractor_space_candidates</a></code></li>
<li><code><a title="pystablemotifs.restrict_space.fixed_rspace_nodes" href="#pystablemotifs.restrict_space.fixed_rspace_nodes">fixed_rspace_nodes</a></code></li>
<li><code><a title="pystablemotifs.restrict_space.partial_state_contradicts_rspace" href="#pystablemotifs.restrict_space.partial_state_contradicts_rspace">partial_state_contradicts_rspace</a></code></li>
<li><code><a title="pystablemotifs.restrict_space.reduce_rspace" href="#pystablemotifs.restrict_space.reduce_rspace">reduce_rspace</a></code></li>
<li><code><a title="pystablemotifs.restrict_space.reduce_rspace_string" href="#pystablemotifs.restrict_space.reduce_rspace_string">reduce_rspace_string</a></code></li>
<li><code><a title="pystablemotifs.restrict_space.rspace" href="#pystablemotifs.restrict_space.rspace">rspace</a></code></li>
<li><code><a title="pystablemotifs.restrict_space.state_in_rspace" href="#pystablemotifs.restrict_space.state_in_rspace">state_in_rspace</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>